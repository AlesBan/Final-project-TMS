@using Playlist_for_party.Models.SpotifyModels.DTO
@model IEnumerable<Playlist_for_party.Models.SpotifyModels.DTO.ItemDto>

@{
    ViewData["Title"] = "Search";
}


@section Styles{
    <link href="@Url.Content("~/css/Search.css")" rel="stylesheet" type="text/css"/>
}

<section class="section">
    <div class="section-titles">
        <h2 class="section-title">Треки</h2>
        <h4 class="popularity">Популярность</h4>
        <h2></h2>
        <h2></h2>
    </div>
    @if (Model.Any())
    {
        <div class="section-content">
            @foreach (var item in Model.Where(i => i.GetType() == typeof(TrackDto)))
            {
                <div class="track">
                    <div class="trackInfo">
                        <a href=@Html.DisplayFor(modelItem => item.Href)>
                            <img src="@Html.DisplayFor(modelItem => item.ImageRef)" alt="Track picture">
                        </a>
                    </div>
                    <div class="track-content">
                        <div class="trackName">@Html.DisplayFor(modelItem => item.Name)</div>
                        <div class="artist">@Html.DisplayFor(modelItem => item.ArtistName)</div>
                    </div>
                </div>
                <div class="trackPopularity">13</div>
                <div class="trackTime">4:11</div>
                <div class="add-btn">
                    <button type="submit" class="floating-button btn-primary" id="@item.Id">Add</button>
                </div>
            }
        </div>
    }

</section>
@* <section class="section"> *@
@*     <h2 class="section-title">Свежие релизы</h2> *@
@*     <div class="section-body"> *@
@*         @if (Model.Any()) *@
@*         { *@
@*             @foreach (var item in Model.Where(i => i.GetType() == typeof(ArtistDto))) *@
@*             { *@
@*                 <div class="card m-1" style="width:200px;"> *@
@*                     <div class="card-body"> *@
@*                         <img style="color: #a2ded8" src="@Html.DisplayFor(modelItem => item.ImageRef)" width="150" height="150" alt="Release picture"/> *@
@*                         <h6 class="card-subtitle mb-2 text-muted" style="color: #a2ded8">@Html.DisplayFor(modelItem => item.Name)</h6> *@
@*                         <a href="@Html.DisplayFor(modelItem => item.Href)" target="_blank">Listen</a> *@
@*                     </div> *@
@*                 </div> *@
@*             } *@
@*         } *@
@*         else *@
@*         { *@
@*             <p style="color: white">No data available</p> *@
@*         } *@
@*     </div> *@
@* </section> *@

@section Scripts
{
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.3.2/jquery.min.js"></script>
    <script>
     $(function (){
        let buttons = document.querySelectorAll("button"); 
            buttons.forEach((butt)=>{
                butt.addEventListener("click", (e) => SendData(e), false)
                
            })
     })
     
    function SendData(event) {
        let trackId = event.target.id;
        $.post("@Url.Action("AddTrackToPlaylist", "Home")", {trackId: trackId})
    }
    </script>
}